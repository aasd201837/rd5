> 2019年5月21日

<a name="ky5cM"></a>
# Shell
Shell 是系统的用户界面，提供了用户和内核进行交互操作的一种接口。同时，Shell 也是一个命令解释器，它解释由用户输入的命令并且把它们送到内核。不仅如此，Shell 有自己的编程语言用于对命令的编辑，它允许用户编写由 shell 命令组成的程序。<br />UNIX/Linux 操作系统下的 Shell 既是用户交互的界面，也是控制系统的脚本语言。当然这一点有别于 Windows 下的命令行，虽然该命令行也提供很简单的控制语句。在 Windows 操作系统下，有些用户从来都不会直接使用 Shell。然而在 UNIX 系列操作系统下，Shell 仍然是控制系统启动和其它很多实用工具的脚本解释程序。

**在 UNIX/Linux 中比较常见的 Shell**

- Bourne Again Shell (简称 bash)
- Bourne Shell（简称 sh）
- C-Shell（简称 csh）
- Korn Shell（简称 ksh）
- Z shell（简称 zsh）

可以通过 `cat /etc/shells` 来查看我们主机上的 shell 类型。
<a name="MOXhC"></a>
## Shell 脚本
```shell
#!/bin/bash
echo "Hello Shiyanlou!"
```
第一行 `#!` 是一个约定的标记，告诉系统这个脚本是用指定的解释程序来执行。不指定时，默认使用 $SHELL 变量的值。<br />执行的脚本需要有可执行权限，可以使用命令 `chmod +x test.sh` 来给文件赋予可执行权限。

<a name="eQ3wV"></a>
# 快捷键

- `tab` 使用 Tab 键来进行命令补全
- 使用键盘上的方向键 `↑` ，恢复之前输入过的命令
- 常用组合键：

| **快捷键** | **说明** |
| --- | --- |
| `control + C`  | 中断操作 |
| `control + D`  | 键盘输入结束或退出终端 |
| `control + S`  | 暂停当前程序，暂停后按下任意键恢复运行 |
| `control + A`  | 将光标移动到命令行首 |
| `control + E`  | 将光标移动到命令行尾 |
| `control + L`  | 清屏 |
| `control + shift + N`  | 新建终端窗口 |

<a name="Muznc"></a>
# Linux 命令格式
```bash
command [options] [arguments]

command：命令
options：选项，定义命令的执行特性，有长短两种选项:
    长选项: 用 -- 引导，后面跟完整的单词，如 --help
    短选项: 用 - 引导，后面跟单个的字符, 如 -a
arguments: 参数，表示命令的作用对象。

在 linux 中，命令的选项和参数所使用的符号也有相应的含义:
    [] :可省略的内容
    <> :必须提供
    a|b :二选一或多选一
    ... :前面的内容可重复出现多次
```

<a name="2inAT"></a>
# 环境变量
Linux 中的环境变量主要分为系统级和用户级，系统级环境变量是每个登录到系统的用户都要读取的变量，而用户级的环境变量则是用户使用系统时加载的个人环境变量。<br />简单来说，环境变量就是指定一个目录，软件在运行的时候，相关程序会按照该目录来查找相关文件。<br />在每个用户的 home 目录中有一个 Shell 每次启动时会默认执行的配置脚本，用来初始化环境，包括添加一些用户自定义环境变量等等。zsh 的配置文件是 .zshrc，相应 bash 的配置文件为 .bashrc 。它们在 etc 下还都有一个或多个全局的配置文件，不过我们一般只修改用户目录下的配置文件。
<a name="58NPV"></a>
## 系统级

- `/etc/profile` 文件：当用户登录 Shell 时执行的第一个文件，用来完成一些初始化工作，通常是调用 `/etc/bash.bashrc` 文件来完成具体工作。
- `/etc/environment` 文件：系统级别的环境变量，并不是一个脚本，内容为一些环境变量赋值语句，用来给不从 Shell 启动的程序设置环境变量。
<a name="kRw42"></a>
## 用户级（文件主要是在 `/home` 目录下）

- `~/.profile` ：每个用户都可以调用来输入自己使用的 shell 信息，不过在用户登录时，该文件只执行一次。
- `~/.bashrc` ：包含登录用户的专用 bash shell 的 bash 信息。也就是说每开一个 shell，该文件都会被读取一次。
<a name="9Ijn4"></a>
## 临时的

- 针对当前 shell 的环境变量。
<a name="LVlmP"></a>
## 设置环境变量的方法

1. `/etc/profile` 文件中添加变量（永久的）

作用于 Linux 下所有用户，且具有永久性。

2. 修改 `~/.profile` 文件（对单一用户生效(永久的)）
2. 直接运行 `export` 命令定义环境变量（临时的）
<a name="hh9Cg"></a>
## 环境变量的查看

1. `export` 命令查看

可以用来显示从 Shell 中导出成环境变量的变量，也能通过它将自定义变量导出为环境变量。

2. `env` 命令查看所有的环境变量

可以用来显示与当前用户相关的环境变量，还可以让命令在指定环境中运行。

3. `set` 命令查看本地定义的环境变量

可以用来显示当前 Shell 中的所有变量，包括其内建环境变量（与 Shell 外观等相关）、用户自定义变量及导出的环境变量。
<a name="UTAW9"></a>
## 修改和删除环境变量
环境变量的修改

| **变量设置方式** | **说明** |
| --- | --- |
| `${变量名#匹配字串}`  | 从头向后开始匹配，删除符合匹配字串的最短数据 |
| `${变量名##匹配字串}`  | 从头向后开始匹配，删除符合匹配字串的最长数据 |
| `${变量名%匹配字串}`  | 从尾向前开始匹配，删除符合匹配字串的最短数据 |
| `${变量名%%匹配字串}`  | 从尾向前开始匹配，删除符合匹配字串的最长数据 |
| `${变量名/旧的字串/新的字串}`  | 将符合旧字串的第一个字串替换为新的字串 |
| `${变量名//旧的字串/新的字串}`  | 将符合旧字串的全部字串替换为新的字串 |

环境变量的删除<br />`unset` 可以用来删除指定的环境变量。
<a name="6PZ3G"></a>
## 环境变量的生效
`source` 命令可以读取并执行指定文件中的命令，这里我们可以通过该命令来让配置的文件立即生效，避免了每次修改配置脚本文件后，还需要退出终端甚至重启之后才能生效的问题。
<a name="o2PmK"></a>
## 常用的环境变量
| **环境变量** | **说明** |
| --- | --- |
| `PATH` | 决定了 shell 将到哪些目录中寻找命令或程序 |
| `HOME` | 当前用户主目录 |
| `HISTSIZE` | 历史记录数 |
| `LOGNAME` | 当前用户的登录名 |
| `HOSTNAME` | 指主机的名称 |
| `SHELL` | 当前用户 Shell 类型 |
| `LANGUGE` | 语言相关的环境变量，多语言可以修改此环境变量 |
| `MAIL` | 当前用户的邮件存放目录 |
| `PS1` | 基本提示符，对于 root 用户是 #，对于普通用户是 $ |
